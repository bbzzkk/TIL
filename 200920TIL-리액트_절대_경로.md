# 200920 TIL - 리액트 절대 경로

## 상대 경로 import 시 문제점

`import utils from '../../../utils/my-utils';`

와 같이 패키지 구조가 깊어질 경우 import 하기 번거로워진다.

`import utils from 'utils/my-utils';`

와 같이 간단하게 import 할 수 없을까?

## 지정된 절대경로로 import 하기

### 1. Babel plugin

.babelrc 설정

```bash
"plugins": [
  [
    "module-resolver",
    {
      "alias": {
        "@/*": "./src"
      }
    }
  ],
  ...
]
```

.babelrc에 module-resolver 설정. src 폴더 기준 '@/utils/my-utils' 가능

### 2. Webpack

webpack.config.js 설정

```javascript
module.esports = {
  ...
  resolve: {
    ...
    alias: {
      '@': path.resolve(__dirname, 'src'),
    },
  },
};
```

## 3. craco (Create React App Configuration Override)

절대 경로를 설정하려면 위와 같이 `babel`이나 `webpack`의 설정을 건드려야 한다.  
CRA는 내부적으로 `webpack`을 숨겨놨기 때문에 `eject`하지 않는 이상 설정을 건드릴 수 없다.  
그러나 프로젝트를 `eject` 하게 되면 React의 버전업에 대해 자동으로 다른 구성요소 및 설정이 변경되는 장점을 잃게 된다.

이를 해결할 수 있는 모듈이 **craco** 이다.

### craco 란?

쉽게 말해 CRA를 위한 configuration layer이다.  
CRA에서 `eject` 사용 없이 **craco.config.js** 파일에 `eslint, babel, webpack` 등 구성들을 customize 할 수 있다.

### 1) craco 설치

`$ yarn add @craco/craco`

### 2) package.json 파일 수정

```json
"scripts": {
    "start": "craco start",
    "build": "craco build",
    "test": "craco test",
    "eject": "react-scripts eject"
}
```

### 3) 프로젝트의 루트에 craco.config.js 파일 생성

```javascript
const path = require('path');

module.exports = {
  webpack: {
    alias: {
      '@': path.resolve(__dirname, 'src/')
    }
  },
  jest: {
    configure: {
      moduleNameMapper: {
        '^@(.*)$': '<rootDir>/src$1'
      }
    }
  }
};
```

## VSCode 가 경로를 추적하게 하기

지금 세팅으로는 VSCode 가 '@utils/my-utils' 경로를 이해하지 못한다. 따라서 파일 추적이 불가능하고 Autocompelete 나 intellisense 기능을 사용할 수 없다.  

아래의 세팅은 VSCode가 파일들을 추적할 수 있게 해준다.  

### 프로젝트의 루트에 jsconfig.json 파일 생성

```bash
{
  "comilerOptions": {
    "baseUrl": "./",
    "paths": {
      "@/*": ["src/*"]
    }
  },
  // 생략...
  "include": [
    "src",
    "craco.config.js"
  ],
  "exclude": [
    "node_modules",
    "**/node_modules/*"
  ]
}
```

## Reference

- [React에서 절대 경로 설정 (craco)](https://kingso.netlify.app/posts/react-craco/)
- [create-react-app-typescript 상대경로를 절대경로로 바꾸기 v2](https://kod4284.github.io/2020/03/08/CRAT-setting-absolute-path-v2/)
- [create-react-app으로 생성한 앱에서 절대 경로 사용하기](https://7stocks.tistory.com/127)
- [multiple class export ~ import 할때 jsconfig.json 설정 (vscode)](https://m.blog.naver.com/PostView.nhn?blogId=mu_kk&logNo=221545339617&proxyReferer=https:%2F%2Fwww.google.com%2F)
- [리액트 상대경로 -> 절대경로 임포트](https://engineering.huiseoul.com/%EB%A6%AC%EC%95%A1%ED%8A%B8-%EC%83%81%EB%8C%80%EA%B2%BD%EB%A1%9C-%EC%A0%88%EB%8C%80%EA%B2%BD%EB%A1%9C-%EB%B3%80%EA%B2%BD-1485babb5198)
- [npm craco 사이트](https://www.npmjs.com/package/@craco/craco)
